<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bike Expense Tracker &ndash; Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
  <link rel="stylesheet" href="assets/css/dashboard.css">
</head>

<body class="dashboard-body">

  <header class="topbar">
    <div class="container-fluid topbar-inner">
      <div class="d-flex align-items-center gap-3">
        <div class="brand-badge">
          <i class="bi bi-speedometer2"></i>
        </div>
        <div>
          <h1 class="brand-title mb-0">Bike Expense Tracker</h1>
          <small id="userTag" class="brand-subtitle text-white-50">Guest</small>
        </div>
      </div>
      <div class="header-actions">
        <button type="button" class="theme-toggle" id="dashThemeToggle" data-theme-toggle aria-pressed="false">
          <span class="theme-icon" data-theme-icon aria-hidden="true">ðŸŒ™</span>
          <span class="theme-toggle-text" data-theme-text>Dark mode</span>
        </button>
        <button id="logoutBtn" class="btn btn-outline-light btn-sm">
          <i class="bi bi-box-arrow-right me-1"></i> Logout
        </button>
      </div>
    </div>
  </header>

  <main class="dashboard-container container-fluid py-5">
    <section id="welcome" class="row g-3 align-items-stretch mb-4">
      <div class="col-12 col-xl-8">
        <div class="card hero-card h-100 shadow-sm border-0">
          <div class="hero-card__badge" id="welcomeBadge">Dashboard</div>
          <h2 class="hero-card__title" id="welcomeTitle">Welcome</h2>
          <p class="hero-card__subtitle" id="welcomeDesc">
            Stay in control of every rupee you invest in your ride — fuel, service, and upgrades — all in one powerful
            workspace.
          </p>

          <p class="hero-card__meta mb-2">
            <strong>Bike Expense Tracker</strong> is your personal riding companion that helps you record every refuel,
            service, and maintenance cost.
            Whether you’re managing your daily commute or planning long trips, this app ensures you always know where
            your money goes — and how efficiently your bike performs.
          </p>

          <p class="hero-card__meta mb-3">
            Designed with simplicity and accuracy in mind, it keeps your entire expense history organized month by
            month.
            You can visualize trends, export reports, and monitor mileage insights — all without needing an internet
            connection.
          </p>

          <ul class="hero-card__list">
            <li>Offline-first storage ensures your data stays safe and private on your device.</li>
            <li>Filter, export, and review your monthly insights in just a few clicks.</li>
            <li>Stay informed with mileage analytics and smart calendar highlights.</li>
          </ul> <div class="hero-card__actions">
            <button class="btn btn-soft btn-sm hero-action-btn" type="button" data-bs-toggle="modal"
              data-bs-target="#aboutModal">
              <i class="bi bi-person-badge me-1"></i>About the Developer
            </button>
            <button class="btn btn-soft btn-sm hero-action-btn hero-action-btn--ghost" type="button"
              data-bs-toggle="modal" data-bs-target="#policyModal">
              <i class="bi bi-shield-check me-1"></i>Policy &amp; Disclaimer
            </button>
          </div>
        </div>
      </div>
      <div class="col-12 col-xl-4">
        <div class="card shadow-sm border-0 h-100 quick-actions">
          <div class="quick-actions__header">
            <div>
              <span class="quick-actions__eyebrow">Stay on track</span>
              <h6 class="mb-1">Quick Actions</h6>
              <p class="quick-actions__copy mb-0">Log spending and jump back into your analysis in seconds.</p>
            </div>
            <div class="quick-actions__icon">
              <i class="bi bi-lightning-charge-fill"></i>
            </div>
          </div>
          <div class="quick-actions__metrics">
            <article class="qa-card">
              <div class="qa-card__icon qa-card__icon--brand">
                <i class="bi bi-calendar-check"></i>
              </div>
              <div>
                <span class="qa-card__label">This Month Spend</span>
                <span class="qa-card__value" id="qaMonthSpend">₹0</span>
                <span class="qa-card__sub" id="qaMonthEntries">Log your first entry</span>
              </div>
            </article>
            <article class="qa-card">
              <div class="qa-card__icon qa-card__icon--mint">
                <i class="bi bi-journal-check"></i>
              </div>
              <div>
                <span class="qa-card__label">Last Entry</span>
                <span class="qa-card__value qa-card__value--sm" id="qaLastEntry">No entries yet</span>
                <span class="qa-card__sub" id="qaQuickNote">Start logging your expenses today.</span>
              </div>
            </article>
            <article class="qa-card">
              <div class="qa-card__icon qa-card__icon--amber">
                <i class="bi bi-graph-up-arrow"></i>
              </div>
              <div>
                <span class="qa-card__label">Top Category</span>
                <span class="qa-card__value qa-card__value--sm" id="qaTopCategory">No spend logged</span>
                <span class="qa-card__sub">Based on total spend</span>
              </div>
            </article>
          </div>
          <div class="quick-actions__cta">
            <a href="#" id="addEntryBtn" class="btn btn-brand w-100">
              <i class="bi bi-plus-lg me-1"></i>Add Expense
            </a>
            <a href="#" id="openList" class="btn btn-soft w-100">
              <i class="bi bi-card-checklist me-1"></i>View All Entries
            </a>
          </div>
        </div>
      </div>
    </section>

    <section class="row g-3 align-items-center mb-4 action-toolbar">
      <div class="col-12 col-xl-8">
        <div class="card shadow-sm border-0 overflow-hidden">
          <div class="card-body d-flex flex-wrap gap-2">
            <button class="btn btn-toolbar-success btn-sm" type="button" onclick="exportData()">
              <i class="bi bi-download me-1"></i>Export Data
            </button>
            <input type="file" id="importFile" accept="application/json" class="d-none" onchange="importData(event)">
            <button class="btn btn-toolbar-info btn-sm" type="button"
              onclick="document.getElementById('importFile').click()">
              <i class="bi bi-file-earmark-arrow-up me-1"></i>Import Data
            </button>
            <button class="btn btn-toolbar-danger btn-sm" type="button" onclick="exportPDF()">
              <i class="bi bi-filetype-pdf me-1"></i>Export PDF
            </button>
            <button class="btn btn-toolbar-warning btn-sm" type="button" onclick="resetAll()">
              <i class="bi bi-trash3 me-1"></i>Clear All
            </button>
          </div>
        </div>
      </div>
      <div class="col-12 col-xl-4">
        <div class="card shadow-sm border-0 h-100">
          <div class="card-body small text-muted">
            Manage, export, or reset your offline records. Keep backups before clearing data.
          </div>
        </div>
      </div>
    </section>

    <section class="card shadow-sm border-0 p-3 p-md-4 mb-4 filter-card">
      <div class="row g-3 align-items-end">
        <div class="col-12 col-md-3">
          <label class="form-label small text-muted mb-1">Category</label>
          <select id="filterCat" class="form-select form-select-sm">
            <option value="">All</option>
            <option>Fuel</option>
            <option>Service</option>
            <option>Modification</option>
            <option>Other</option>
          </select>
        </div>
        <div class="col-12 col-md-3">
          <label class="form-label small text-muted mb-1">Month</label>
          <input type="month" id="filterMonth" class="form-control form-control-sm">
        </div>
        <div class="col-12 col-md-3">
          <label class="form-label small text-muted mb-1">Sort By</label>
          <select id="sortBy" class="form-select form-select-sm">
            <option value="date_desc">Date &darr; (latest)</option>
            <option value="date_asc">Date &uarr;</option>
            <option value="amt_desc">Amount &darr; (highest)</option>
            <option value="amt_asc">Amount &uarr;</option>
          </select>
        </div>
        <div class="col-12 col-md-3 d-flex gap-2 justify-content-md-end">
          <button class="btn btn-brand btn-sm flex-grow-1 flex-md-grow-0" type="button"
            onclick="applyFilter()">Apply</button>
          <button class="btn btn-soft btn-sm flex-grow-1 flex-md-grow-0" type="button"
            onclick="resetFilter()">Reset</button>
        </div>
      </div>
    </section>

    <section id="appArea">
      <ul class="nav nav-pills dash-tabs mb-4" id="dashTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tabCalendar"
            type="button">Calendar</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabList" type="button">List</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabInsights" type="button">Insights</button>
        </li>
      </ul>

      <div class="tab-content">
        <div class="tab-pane fade show active" id="tabCalendar">
          <div class="card shadow-sm border-0 mb-3">
            <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
              <div class="d-flex align-items-center gap-2">
                <button class="btn btn-icon" type="button" id="calPrev" aria-label="Previous month">
                  <i class="bi bi-chevron-left"></i>
                </button>
                <h5 class="mb-0" id="calTitle">Month YYYY</h5>
                <button class="btn btn-icon" type="button" id="calNext" aria-label="Next month">
                  <i class="bi bi-chevron-right"></i>
                </button>
              </div>
              <button class="btn btn-gradient btn-sm" type="button" data-bs-toggle="modal" data-bs-target="#addModal">
                <i class="bi bi-plus-lg me-1"></i>Add Expense
              </button>
            </div>
          </div>

          <div class="card shadow-sm border-0">
            <div class="card-body">
              <div class="cal-weekdays d-grid text-center fw-semibold">
                <div>Sun</div>
                <div>Mon</div>
                <div>Tue</div>
                <div>Wed</div>
                <div>Thu</div>
                <div>Fri</div>
                <div>Sat</div>
              </div>
              <div id="calGrid" class="cal-grid d-grid"></div>
              <div class="mt-3 small text-muted" id="monthTotalText">-</div>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="tabList">
          <div class="card shadow-sm border-0 mb-4">
            <div class="card-body d-flex justify-content-between align-items-center flex-wrap gap-2">
              <div>
                <h5 class="mb-1">Your Monthly Expenses</h5>
                <div id="summaryStats" class="small text-muted mb-0">No entries yet.</div>
              </div>
              <button class="btn btn-gradient btn-sm" type="button" data-bs-toggle="modal" data-bs-target="#addModal">
                <i class="bi bi-plus-lg me-1"></i>Add Expense
              </button>
            </div>
          </div>

          <div class="card shadow-sm border-0">
            <div class="table-responsive">
              <table class="table table-hover align-middle mb-0" id="entriesTable">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Category</th>
                    <th>Amount (&#8377;)</th>
                    <th>Liters</th>
                    <th>Odometer</th>
                    <th>Notes</th>
                    <th class="text-end">Actions</th>
                  </tr>
                </thead>
                <tbody id="entriesBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="tabInsights">
          <div class="card shadow-sm border-0 mb-3">
            <div class="card-body">
              <h5 class="mb-1">This Month &ndash; Insights</h5>
              <div class="small text-muted" id="insightsSummary">-</div>
            </div>
          </div>

          <div class="card shadow-sm border-0 mb-3">
            <div class="card-body">
              <canvas id="categoryChart" height="120"></canvas>
            </div>
          </div>

          <div class="card shadow-sm border-0" id="mileageBreakdownCard">
            <div class="card-body">
              <h5 class="mb-3">Mileage Breakdown</h5>
              <div id="mileageTableWrap" class="table-responsive small text-muted">
                No mileage data yet.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <div class="app-footer__inner">
      <div class="small app-footer__tip">Need help? Export data regularly to keep backups handy.</div>
      <div class="small app-footer__credit">Design &amp; Developed by <a href="https://lucifer01430.github.io/Portfolio"
          target="_blank" rel="noopener">Harsh Pandey</a></div>
    </div>
  </footer>

  <div class="modal fade" id="welcomeModal" tabindex="-1" aria-labelledby="welcomeModalLabel" aria-hidden="true"
    data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered modal-sm modal-pro">
      <div class="modal-content modal-pro__content">
        <div class="modal-header modal-pro__header modal-pro__header--brand">
          <div class="modal-pro__icon">
            <i class="bi bi-hand-thumbs-up"></i>
          </div>
          <div class="modal-pro__heading">
            <span class="modal-pro__eyebrow">Welcome back</span>
            <h5 class="modal-title mb-0" id="welcomeModalLabel">Ready to ride smarter?</h5>
          </div>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body modal-pro__body">
          <p class="mb-3">Your dashboard keeps fuel, service, and upgrade expenses synced in one place.</p>
          <ul class="modal-pro__list">
            <li>Log today's fill-up or service in seconds.</li>
            <li>Use filters to compare months and spot trends.</li>
          </ul>
          <div class="modal-pro__footer">
            <button class="btn btn-brand w-100" type="button" id="welcomeContinue">
              Enter dashboard
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="aboutModal" tabindex="-1" aria-labelledby="aboutModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-md modal-pro">
      <div class="modal-content modal-pro__content">
        <div class="modal-header modal-pro__header modal-pro__header--brand">
          <div class="modal-pro__icon">
            <i class="bi bi-person-hearts"></i>
          </div>
          <div class="modal-pro__heading">
            <span class="modal-pro__eyebrow">Creator spotlight</span>
            <h5 class="modal-title mb-0" id="aboutModalLabel">About the developer</h5>
          </div>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body modal-pro__body">
          <p>
            Hi, I'm <strong>Harsh Pandey</strong> &mdash; a product-focused developer who enjoys designing fast,
            reliable tools for everyday riders. My goal with Bike Expense Tracker is to blend clean design with
            practical insights so you can manage fuel, service, and upgrade costs without jumping between spreadsheets.
          </p>
          <div class="modal-pro__divider"></div>
          <ul class="modal-pro__list">
            <li>Crafts offline-first, mobile-friendly experiences for riders.</li>
            <li>Focuses on privacy-first data control with intuitive dashboards.</li>
            <li>Believes that every rupee logged should unlock a clear decision.</li>
          </ul>
          <div class="modal-pro__callout">
            Feedback helps shape the roadmap. Drop a note if you have ideas to level up the tracker.
          </div>
          <div class="modal-pro__cta">
            <a class="btn btn-soft w-100" href="https://lucifer01430.github.io/Portfolio" target="_blank"
              rel="noopener">
              <i class="bi bi-window-plus me-1"></i>Visit portfolio
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="policyModal" tabindex="-1" aria-labelledby="policyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-md modal-pro">
      <div class="modal-content modal-pro__content">
        <div class="modal-header modal-pro__header modal-pro__header--slate">
          <div class="modal-pro__icon">
            <i class="bi bi-shield-lock"></i>
          </div>
          <div class="modal-pro__heading">
            <span class="modal-pro__eyebrow">Policy update</span>
            <h5 class="modal-title mb-0" id="policyModalLabel">Policy &amp; disclaimer</h5>
          </div>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body modal-pro__body">
          <p>
            Bike Expense Tracker is an offline-first web app created and copyrighted by <strong>Harsh Pandey</strong>.
            It exists to help riders record fuel fills, service history, and mileage so they can make smarter ownership
            decisions.
          </p>
          <div class="modal-pro__divider"></div>
          <ul class="modal-pro__list">
            <li>All expense data stays on your device unless you export it.</li>
            <li>The app is provided as-is; verify financial figures before sharing.</li>
            <li>Redistribution is not allowed without written permission from the developer.</li>
          </ul>
          <div class="modal-pro__callout">
            Purpose-built for personal tracking &mdash; use it to understand running costs, plan budgets, and compare
            ride performance over time.
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="addModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <form id="addExpenseForm">
          <div class="modal-header">
            <h5 class="modal-title">Add Expense</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Date</label>
              <input type="date" class="form-control" id="expDate" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Category</label>
              <select class="form-select" id="expCategory" required onchange="toggleFuelFields()">
                <option value="">Select</option>
                <option>Fuel</option>
                <option>Service</option>
                <option>Modification</option>
                <option>Other</option>
              </select>
            </div>
            <div class="row">
              <div class="col-12 mb-3">
                <label class="form-label">Amount (&#8377;)</label>
                <input type="number" class="form-control" id="expAmount" min="1" required>
              </div>
              <div class="row fuel-fields d-none">
                <div class="col-12 col-md-6 mb-3">
                  <label class="form-label">Fuel Liters</label>
                  <input type="number" class="form-control" id="expLiters" step="0.01" placeholder="e.g. 5.6">
                </div>
                <div class="col-12 col-md-6 mb-3">
                  <label class="form-label">Odometer (km)</label>
                  <input type="number" class="form-control" id="expOdo" placeholder="e.g. 23890">
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label">Notes</label>
              <input type="text" class="form-control" id="expNotes" placeholder="Optional">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-soft" data-bs-dismiss="modal">Cancel</button>
            <button class="btn btn-brand" type="submit">Save</button>
          </div>
          <input type="hidden" id="editId">
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="assets/js/theme.js"></script>
  <script>
    (function () {
      if (typeof Swal === 'undefined') return;
      const iconFor = (message) => {
        const text = message.toLowerCase();
        if (/(error|invalid|fail|wrong|missing|not\sfound)/.test(text)) return 'error';
        if (/(clear|delete|remove|warning)/.test(text)) return 'warning';
        if (/(success|added|updated|import|export|saved)/.test(text)) return 'success';
        return 'info';
      };
      const clean = (message) => String(message ?? '')
        .replace(/\uFFFD/g, '')
        .replace(/[^\S\r\n]+/g, ' ')
        .trim() || 'Done';
      window.alert = function (message) {
        const text = clean(message);
        Swal.fire({
          toast: true,
          icon: iconFor(text),
          title: text,
          position: 'top-end',
          showConfirmButton: false,
          timer: 2400,
          timerProgressBar: true,
          customClass: { popup: 'swal2-toast' },
          didOpen: (toast) => {
            toast.addEventListener('mouseenter', Swal.stopTimer);
            toast.addEventListener('mouseleave', Swal.resumeTimer);
          }
        });
      };
    })();
  </script>
  <script src="assets/js/dashboard.js"></script>
</body>

</html>